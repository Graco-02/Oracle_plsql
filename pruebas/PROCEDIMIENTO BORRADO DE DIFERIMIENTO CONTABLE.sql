SET SERVEROUTPUT ON;
exec dbms_output.enable(NULL);
DECLARE 
  CODENT_AUX DEBUSAT.PCDT648.CODENT%TYPE;
  CENTALTA_AUX DEBUSAT.PCDT648.CENTALTA%TYPE;
  CUENTA_AUX DEBUSAT.PCDT648.CUENTA%TYPE;
  NUMBENCTA_AUX DEBUSAT.PCDT648.NUMBENCTA%TYPE;

  
  DATOS_MPDT009 DEBUSAT.MPDT009%ROWTYPE;
  DATOS_PCDT648 DEBUSAT.PCDT648%ROWTYPE;
  DATOS_PCDT730 DEBUSAT.PCDT730%ROWTYPE;
  
  CURSOR TARJETAS IS SELECT * FROM DEBUSAT.MPDT009 WHERE CODENT ='0720' 
  AND (CUENTA,PAN) IN(
('000000003287','4872791120076436'),
('000000003287','4872791120260436'),
('000000003578','4960821130269672'),
('000000004858','4960821130262073'),
('000000004959','4960821130248601'),
('000000005402','4960821130269003'),
('000000006786','4960821130213191'),
('000000008487','4960821130273153'),
('000000011447','4960821130256919'),
('000000013397','4960821130201758'),
('000000018150','4960821130263402'),
('000000020688','4960821130256083'),
('000000020759','4960821130255689'),
('000000021086','4960821130242448'),
('000000021567','4960821130253726'),
('000000021773','4646901150017680'),
('000000022073','4960821130242059'),
('000000022681','4960821130034423'),
('000000022798','4960821130259145'),
('000000023434','4960821130226417'),
('000000027673','4960821130246639'),
('000000031489','4678631150002223'),
('000000031489','4678631150024961'),
('000000033104','4646891140005855'),
('000000037930','4773651101118245'),
('000000038135','4960821130054173'),
('000000040190','4960821130050791'),
('000000041324','4678631150028319'),
('000000048000','4960821130237133'),
('000000056270','4678631150018906'),
('000000057860','4960821130237489'),
('000000059913','4960821130260622'),
('000000061036','4960821130239162'),
('000000061036','4960821130239162'),
('000000061472','4960821130235095'),
('000000066766','4960821130257214')); 
  
CURSOR CURSOR_PCDT648 IS SELECT * FROM DEBUSAT.PCDT648 WHERE CODENT = CODENT_AUX AND CENTALTA = CENTALTA_AUX AND CUENTA = CUENTA_AUX AND NUMBENCTA = NUMBENCTA_AUX;
CURSOR CURSOR_PCDT730 IS SELECT * FROM DEBUSAT.PCDT730 WHERE CODENT = CODENT_AUX 
AND (PAN,CODCONECO) IN(
('4872791120076436','125'),
('4872791120260436','122'),
('4960821130269672','125'),
('4960821130262073','122'),
('4960821130248601','122'),
('4960821130269003','122'),
('4960821130213191','122'),
('4960821130273153','125'),
('4960821130256919','122'),
('4960821130201758','122'),
('4960821130263402','122'),
('4960821130256083','122'),
('4960821130255689','122'),
('4960821130242448','122'),
('4960821130253726','122'),
('4646901150017680','920'),
('4960821130242059','122'),
('4960821130034423','122'),
('4960821130259145','122'),
('4960821130226417','122'),
('4960821130246639','124'),
('4678631150002223','125'),
('4678631150024961','125'),
('4646891140005855','920'),
('4773651101118245','122'),
('4960821130054173','122'),
('4960821130050791','122'),
('4678631150028319','122'),
('4960821130237133','920'),
('4678631150018906','124'),
('4960821130237489','122'),
('4960821130260622','122'),
('4960821130239162','122'),
('4960821130239162','920'),
('4960821130235095','125'),
('4960821130257214','122')
);
BEGIN
       OPEN TARJETAS;
       DBMS_OUTPUT.PUT_LINE('************************************************************************************************************************************');
       DBMS_OUTPUT.PUT_LINE('------------------------------DATOS PCDT648-----------------------------------------');    
       LOOP
          FETCH TARJETAS INTO DATOS_MPDT009;
          EXIT WHEN TARJETAS%NOTFOUND;
          CODENT_AUX:=DATOS_MPDT009.CODENT;
          CENTALTA_AUX:=DATOS_MPDT009.CENTALTA;
          CUENTA_AUX:=DATOS_MPDT009.CUENTA;
          NUMBENCTA_AUX:=DATOS_MPDT009.NUMBENCTA;
          --DBMS_OUTPUT.PUT_LINE(CODENT_AUX||';'||CENTALTA_AUX||';'||CUENTA_AUX||';'||NUMBENCTA_AUX);
          OPEN CURSOR_PCDT648;      
          LOOP
            FETCH CURSOR_PCDT648 INTO DATOS_PCDT648;
            EXIT WHEN CURSOR_PCDT648%NOTFOUND;
            DBMS_OUTPUT.PUT_LINE(DATOS_PCDT648.CODENT||';'||DATOS_PCDT648.CENTALTA||';'||DATOS_PCDT648.CUENTA||';'||
            DATOS_PCDT648.NUMBENCTA||';'||DATOS_PCDT648.TIPCUOTA||';'||DATOS_PCDT648.IMPCUOTOT||';'||
            DATOS_PCDT648.IMPCUOTA||';'||DATOS_PCDT648.CUOTOT||';'||DATOS_PCDT648.CUOBON||';'||
            DATOS_PCDT648.CUOPAG||';'||DATOS_PCDT648.FECALTA||';'||DATOS_PCDT648.FECCADTAR||';'||DATOS_PCDT648.CODENTUMO
            ||';'||DATOS_PCDT648.CODOFIUMO||';'||DATOS_PCDT648.USUARIOUMO||';'||DATOS_PCDT648.CODTERMUMO||';'||DATOS_PCDT648.CONTCUR);
          END LOOP;--FIN DEL LOOP PCDT648
          CLOSE CURSOR_PCDT648;
         
       END LOOP;--FIN DEL LOOP MPDT009
       CLOSE TARJETAS;
       DBMS_OUTPUT.PUT_LINE('************************************************************************************************************************************');
       
       DBMS_OUTPUT.PUT_LINE('------------------------------DATOS PCDT730-----------------------------------------');    
          OPEN CURSOR_PCDT730;      
          LOOP
            FETCH CURSOR_PCDT730 INTO DATOS_PCDT730;
            EXIT WHEN CURSOR_PCDT730%NOTFOUND;
            DBMS_OUTPUT.PUT_LINE(
            DATOS_PCDT730.CODENT||';'||DATOS_PCDT730.CENTALTA||';'||DATOS_PCDT730.CUENTA||';'||
            DATOS_PCDT730.PAN||';'||DATOS_PCDT730.CLAMON||';'||
            DATOS_PCDT730.NUMEXTCTA||';'||DATOS_PCDT730.CODCONECO
            ||';'||DATOS_PCDT730.IMPCUOTOT||';'||DATOS_PCDT730.IMPCUODIFMES
            ||';'||DATOS_PCDT730.FECCARGO||';'||DATOS_PCDT730.IDENTCLI
            ||';'||DATOS_PCDT730.NUMBENCTA||';'||DATOS_PCDT730.CALPART
            ||';'||DATOS_PCDT730.FECALTA||';'||DATOS_PCDT730.FECCADTAR
            ||';'||DATOS_PCDT730.FECFACTU||';'||DATOS_PCDT730.FECAPLI
            ||';'||DATOS_PCDT730.CODENTUMO||';'||DATOS_PCDT730.CODOFIUMO
            ||';'||DATOS_PCDT730.USUARIOUMO||';'||DATOS_PCDT730.CODTERMUMO
            ||';'||DATOS_PCDT730.CONTCUR
            );
          END LOOP;--FIN DEL LOOP PCDT730
          CLOSE CURSOR_PCDT730;
        DBMS_OUTPUT.PUT_LINE('************************************************************************************************************************************');
          
END;




